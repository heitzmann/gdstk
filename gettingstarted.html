

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Getting Started &mdash; gdstk 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=34bb78ad" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=4c969af8" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=a12e3537"></script>
      <script src="_static/doctools.js?v=fd6eb6e6"></script>
      <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="_static/tabs.js?v=3ee01567"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="How-Tos" href="how-tos.html" />
    <link rel="prev" title="Gdstk Documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            gdstk
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#first-layout">First Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="#polygons">Polygons</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#holes">Holes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#circles">Circles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#curves">Curves</a></li>
<li class="toctree-l3"><a class="reference internal" href="#transformations">Transformations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#layer-and-datatype">Layer and Datatype</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="#paths">Paths</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#flexible-paths">Flexible Paths</a></li>
<li class="toctree-l3"><a class="reference internal" href="#robust-paths">Robust Paths</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#text">Text</a></li>
<li class="toctree-l2"><a class="reference internal" href="#geometry-operations">Geometry Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#boolean-operations">Boolean Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#slice-operation">Slice Operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#offset-operation">Offset Operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fillet-operation">Fillet Operation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gdsii-oasis-library">GDSII/OASIS Library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#a-note-about-units">A Note About Units</a></li>
<li class="toctree-l3"><a class="reference internal" href="#saving-a-layout-file">Saving a Layout File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loading-a-layout-file">Loading a Layout File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#raw-cells">Raw Cells</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="how-tos.html">How-Tos</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference_python.html">Python API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference_cpp.html">C++ Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">gdstk</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Getting Started</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="getting-started">
<span id="id1"></span><h1>Getting Started<a class="headerlink" href="#getting-started" title="Link to this heading"></a></h1>
<p>GDSII files contain a hierarchical representation of any polygonal geometry.
They are mainly used in the microelectronics industry for the design of mask
layouts, but are also employed in other areas.</p>
<p>Because it is a hierarchical format, repeated structures, such as identical
transistors, can be defined once and referenced multiple times in the layout,
reducing the file size.</p>
<p>There is one important limitation in the GDSII format: it only supports <a class="reference external" href="https://en.wikipedia.org/wiki/Simple_polygon">weakly
simple polygons</a>, that is,
polygons whose segments are allowed to intersect, but not cross.</p>
<p>In particular, curves and shapes with holes are <em>not</em> directly supported.
Holes can be defined, nonetheless, by connecting their boundary to the boundary
of the enclosing shape.  In the case of curves, they must be approximated by a
polygon.  The number of points in the polygonal approximation can be increased
to better approximate the original curve up to some acceptable error.</p>
<p>The original GDSII format limits the number of vertices in a polygon to 199.
This limit seems arbitrary, as the maximal number of vertices that can be
stored in a GDSII record is 8190.  Nonetheless, most modern software disregard
both limits and allow an arbitrary number of points per polygon.  Gdstk follows
the modern version of GDSII, but this is an important issue to keep in mind if
the generated file is to be used in older systems.</p>
<p>The units used to represent shapes in the GDSII format are defined by the user.
The default unit in Gdstk is 1 µm (10⁻⁶ m), but that can be easily changed by
the user.</p>
<section id="first-layout">
<span id="id2"></span><h2>First Layout<a class="headerlink" href="#first-layout" title="Link to this heading"></a></h2>
<p>Let’s create our first layout file:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio" /><label class="tab-label" for="tab-set--0-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">gdstk</span>

<span class="c1"># The GDSII file is called a library, which contains multiple cells.</span>
<span class="n">lib</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Library</span><span class="p">()</span>

<span class="c1"># Geometry must be placed in cells.</span>
<span class="n">cell</span> <span class="o">=</span> <span class="n">lib</span><span class="o">.</span><span class="n">new_cell</span><span class="p">(</span><span class="s2">&quot;FIRST&quot;</span><span class="p">)</span>

<span class="c1"># Create the geometry (a single rectangle) and add it to the cell.</span>
<span class="n">rect</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">cell</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rect</span><span class="p">)</span>

<span class="c1"># Save the library in a GDSII or OASIS file.</span>
<span class="n">lib</span><span class="o">.</span><span class="n">write_gds</span><span class="p">(</span><span class="s2">&quot;first.gds&quot;</span><span class="p">)</span>
<span class="n">lib</span><span class="o">.</span><span class="n">write_oas</span><span class="p">(</span><span class="s2">&quot;first.oas&quot;</span><span class="p">)</span>

<span class="c1"># Optionally, save an image of the cell as SVG.</span>
<span class="n">cell</span><span class="o">.</span><span class="n">write_svg</span><span class="p">(</span><span class="s2">&quot;first.svg&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio" /><label class="tab-label" for="tab-set--0-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;gdstk/gdstk.hpp&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">gdstk</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">argv</span><span class="p">[])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Library</span><span class="w"> </span><span class="n">lib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">    </span><span class="n">lib</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="s">&quot;library&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">1e-6</span><span class="p">,</span><span class="w"> </span><span class="mf">1e-9</span><span class="p">);</span>

<span class="w">    </span><span class="n">Cell</span><span class="w"> </span><span class="n">cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">    </span><span class="n">cell</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy_string</span><span class="p">(</span><span class="s">&quot;FIRST&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="w">    </span><span class="n">lib</span><span class="p">.</span><span class="n">cell_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cell</span><span class="p">);</span>

<span class="w">    </span><span class="n">Polygon</span><span class="w"> </span><span class="n">rect</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rectangle</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="n">make_tag</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">));</span>
<span class="w">    </span><span class="n">cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">&amp;</span><span class="n">rect</span><span class="p">);</span>

<span class="w">    </span><span class="n">lib</span><span class="p">.</span><span class="n">write_gds</span><span class="p">(</span><span class="s">&quot;first.gds&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="w">    </span><span class="n">lib</span><span class="p">.</span><span class="n">write_oas</span><span class="p">(</span><span class="s">&quot;first.oas&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="n">OASIS_CONFIG_DETECT_ALL</span><span class="p">);</span>
<span class="w">    </span><span class="n">cell</span><span class="p">.</span><span class="n">write_svg</span><span class="p">(</span><span class="s">&quot;first.svg&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#222222&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="n">rect</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">cell</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">lib</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>After importing the <code class="docutils literal notranslate"><span class="pre">gdstk</span></code> module, we create a library <code class="docutils literal notranslate"><span class="pre">lib</span></code> to hold the
design.</p>
<p>All layout elements must be added to cells, which can be though of pieces of
papers where the geometry is drawn.  Later, a cell can reference others to
build hierarchical designs, as if stamping the referenced cell into the first,
as we’ll see in <a class="reference internal" href="#references"><span class="std std-ref">References</span></a>.</p>
<p>We create a <a class="reference internal" href="library/gdstk.Cell.html#gdstk.Cell" title="gdstk.Cell"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.Cell</span></code></a> with name “FIRST” (cells are identified by
name, therefore cell names must be unique within a library) and add a
<a class="reference internal" href="geometry/gdstk.rectangle.html#gdstk.rectangle" title="gdstk.rectangle"><code class="xref py py-func docutils literal notranslate"><span class="pre">gdstk.rectangle()</span></code></a> to it.</p>
<p>Finally, the whole library is saved in a GDSII file called “first.gds” and an
OASIS file “first.oas” in the current directory.  The GDSII or OASIS files can
be opened in a number of viewers and editors, such as <a class="reference external" href="https://klayout.de/">KLayout</a>.</p>
</section>
<section id="polygons">
<h2>Polygons<a class="headerlink" href="#polygons" title="Link to this heading"></a></h2>
<p>General polygons can be defined by an ordered list of vertices.  The
orientation of the vertices (clockwise/counter-clockwise) is not important:
they will be ordered internally.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio" /><label class="tab-label" for="tab-set--1-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a polygon from a list of vertices</span>
<span class="n">points</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio" /><label class="tab-label" for="tab-set--1-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">example_polygons</span><span class="p">(</span><span class="n">Cell</span><span class="o">&amp;</span><span class="w"> </span><span class="n">out_cell</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Vec2</span><span class="w"> </span><span class="n">points</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">-6</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">-6</span><span class="p">,</span><span class="w"> </span><span class="mi">-6</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">-4</span><span class="p">,</span><span class="w"> </span><span class="mi">-4</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">-4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">}};</span>

<span class="w">    </span><span class="c1">// This has to be heap-allocated so that it doesn&#39;t go out of scope once</span>
<span class="w">    </span><span class="c1">// the function returns.  We also don&#39;t worry about leaking it at the end</span>
<span class="w">    </span><span class="c1">// of the program.  The OS will take care of it.</span>
<span class="w">    </span><span class="n">Polygon</span><span class="o">*</span><span class="w"> </span><span class="n">poly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Polygon</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Polygon</span><span class="p">));</span>
<span class="w">    </span><span class="n">poly</span><span class="o">-&gt;</span><span class="n">point_array</span><span class="p">.</span><span class="n">extend</span><span class="p">({.</span><span class="n">capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">points</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">points</span><span class="p">});</span>
<span class="w">    </span><span class="n">out_cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">poly</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<img alt="_images/polygons.svg" class="align-center" src="_images/polygons.svg" />
<section id="holes">
<h3>Holes<a class="headerlink" href="#holes" title="Link to this heading"></a></h3>
<p>As mentioned in <a class="reference internal" href="#getting-started"><span class="std std-ref">Getting Started</span></a>, holes have to be connected to the outer
boundary of the polygon, as in the following example:</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio" /><label class="tab-label" for="tab-set--2-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Manually connect the hole to the outer boundary</span>
<span class="n">cutout</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span>
    <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio" /><label class="tab-label" for="tab-set--2-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">example_holes</span><span class="p">(</span><span class="n">Cell</span><span class="o">&amp;</span><span class="w"> </span><span class="n">out_cell</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Vec2</span><span class="w"> </span><span class="n">points</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span>
<span class="w">                     </span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">}};</span>
<span class="w">    </span><span class="n">Polygon</span><span class="o">*</span><span class="w"> </span><span class="n">poly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Polygon</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Polygon</span><span class="p">));</span>
<span class="w">    </span><span class="n">poly</span><span class="o">-&gt;</span><span class="n">point_array</span><span class="p">.</span><span class="n">extend</span><span class="p">({.</span><span class="n">capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">points</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">points</span><span class="p">});</span>
<span class="w">    </span><span class="n">out_cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">poly</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<img alt="_images/holes.svg" class="align-center" src="_images/holes.svg" />
</section>
<section id="circles">
<h3>Circles<a class="headerlink" href="#circles" title="Link to this heading"></a></h3>
<p>The <a class="reference internal" href="geometry/gdstk.ellipse.html#gdstk.ellipse" title="gdstk.ellipse"><code class="xref py py-func docutils literal notranslate"><span class="pre">gdstk.ellipse()</span></code></a> function creates circles, ellipses, doughnuts, arcs
and slices.  In all cases, the argument <code class="docutils literal notranslate"><span class="pre">tolerance</span></code> will control the number
of vertices used to approximate the curved shapes.</p>
<p>When saving a library with <a class="reference internal" href="library/gdstk.Library.html#gdstk.Library.write_gds" title="gdstk.Library.write_gds"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gdstk.Library.write_gds()</span></code></a>, if the number of
vertices in the polygon is larger than <code class="docutils literal notranslate"><span class="pre">max_points</span></code> (199 by default), it will
be fractured in many smaller polygons with at most <code class="docutils literal notranslate"><span class="pre">max_points</span></code> vertices
each.</p>
<p>OASIS files don’t have a limit to the number of polygon vertices, so no
polygons are fractured when saving.  They also have support for circles.  When
saving an OASIS file, polygonal circles will be detected within a predefined
tolerance and automatically converted.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio" /><label class="tab-label" for="tab-set--3-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Circle centered at (0, 0), with radius 2 and tolerance 0.1</span>
<span class="n">circle</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">ellipse</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># To create an ellipse, simply pass a list with 2 radii.</span>
<span class="c1"># Because the tolerance is small (resulting a large number of</span>
<span class="c1"># vertices), the ellipse is fractured in 2 polygons.</span>
<span class="n">ellipse</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">ellipse</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>

<span class="c1"># Circular arc example</span>
<span class="n">arc</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">ellipse</span><span class="p">(</span>
    <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
    <span class="mi">2</span><span class="p">,</span>
    <span class="n">inner_radius</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">initial_angle</span><span class="o">=-</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>
    <span class="n">final_angle</span><span class="o">=</span><span class="mf">1.2</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio" /><label class="tab-label" for="tab-set--3-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">example_circles</span><span class="p">(</span><span class="n">Cell</span><span class="o">&amp;</span><span class="w"> </span><span class="n">out_cell</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Polygon</span><span class="o">*</span><span class="w"> </span><span class="n">circle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Polygon</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Polygon</span><span class="p">));</span>
<span class="w">    </span><span class="o">*</span><span class="n">circle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ellipse</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">out_cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">circle</span><span class="p">);</span>

<span class="w">    </span><span class="n">Polygon</span><span class="o">*</span><span class="w"> </span><span class="n">ellipse_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Polygon</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Polygon</span><span class="p">));</span>
<span class="w">    </span><span class="o">*</span><span class="n">ellipse_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ellipse</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">1e-4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">out_cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">ellipse_</span><span class="p">);</span>

<span class="w">    </span><span class="n">Polygon</span><span class="o">*</span><span class="w"> </span><span class="n">arc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Polygon</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Polygon</span><span class="p">));</span>
<span class="w">    </span><span class="o">*</span><span class="n">arc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ellipse</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">},</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">M_PI</span><span class="p">,</span><span class="w"> </span><span class="mf">1.2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">M_PI</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">out_cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">arc</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<img alt="_images/circles.svg" class="align-center" src="_images/circles.svg" />
</section>
<section id="curves">
<h3>Curves<a class="headerlink" href="#curves" title="Link to this heading"></a></h3>
<p>Constructing complex polygons by manually listing all vertices in
<a class="reference internal" href="geometry/gdstk.Polygon.html#gdstk.Polygon" title="gdstk.Polygon"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.Polygon</span></code></a> can be challenging.  The class <a class="reference internal" href="geometry/gdstk.Curve.html#gdstk.Curve" title="gdstk.Curve"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.Curve</span></code></a> can
be used to facilitate the creation of polygons by drawing their shapes
step-by-step.  The syntax is inspired by the <a class="reference external" href="https://www.w3.org/TR/SVG/paths.html">SVG path specification</a>.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio" /><label class="tab-label" for="tab-set--4-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct a curve made of a sequence of line segments</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Curve</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">segment</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span><span class="n">c1</span><span class="o">.</span><span class="n">points</span><span class="p">())</span>

<span class="c1"># Construct another curve using relative coordinates</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Curve</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">segment</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="n">relative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span><span class="n">c2</span><span class="o">.</span><span class="n">points</span><span class="p">())</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio" /><label class="tab-label" for="tab-set--4-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">example_curves1</span><span class="p">(</span><span class="n">Cell</span><span class="o">&amp;</span><span class="w"> </span><span class="n">out_cell</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Vec2</span><span class="w"> </span><span class="n">points</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">}};</span>

<span class="w">    </span><span class="c1">// Curve points will be copied to the polygons, so allocating the curve on</span>
<span class="w">    </span><span class="c1">// the stack is fine.</span>
<span class="w">    </span><span class="n">Curve</span><span class="w"> </span><span class="n">c1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">    </span><span class="n">c1</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="mf">0.01</span><span class="p">);</span>
<span class="w">    </span><span class="n">c1</span><span class="p">.</span><span class="n">segment</span><span class="p">({.</span><span class="n">capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">points</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">points</span><span class="p">},</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>

<span class="w">    </span><span class="n">Polygon</span><span class="o">*</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Polygon</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Polygon</span><span class="p">));</span>
<span class="w">    </span><span class="n">p1</span><span class="o">-&gt;</span><span class="n">point_array</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">c1</span><span class="p">.</span><span class="n">point_array</span><span class="p">);</span>
<span class="w">    </span><span class="n">out_cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">p1</span><span class="p">);</span>
<span class="w">    </span><span class="n">c1</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>

<span class="w">    </span><span class="n">Curve</span><span class="w"> </span><span class="n">c2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">    </span><span class="n">c2</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="mf">0.01</span><span class="p">);</span>
<span class="w">    </span><span class="n">c2</span><span class="p">.</span><span class="n">segment</span><span class="p">({.</span><span class="n">capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">points</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">points</span><span class="p">},</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>

<span class="w">    </span><span class="n">Polygon</span><span class="o">*</span><span class="w"> </span><span class="n">p2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Polygon</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Polygon</span><span class="p">));</span>
<span class="w">    </span><span class="n">p2</span><span class="o">-&gt;</span><span class="n">point_array</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">c2</span><span class="p">.</span><span class="n">point_array</span><span class="p">);</span>
<span class="w">    </span><span class="n">out_cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">p2</span><span class="p">);</span>
<span class="w">    </span><span class="n">c2</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<img alt="_images/curves.svg" class="align-center" src="_images/curves.svg" />
<p>Coordinate pairs can be given as a complex number: real and imaginary parts are
used as x and y coordinates, respectively.  That is useful to define points in
polar coordinates.</p>
<p>Elliptical arcs have syntax similar to <a class="reference internal" href="geometry/gdstk.ellipse.html#gdstk.ellipse" title="gdstk.ellipse"><code class="xref py py-func docutils literal notranslate"><span class="pre">gdstk.ellipse()</span></code></a>, but they allow
for an extra rotation of the major axis of the ellipse.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio" /><label class="tab-label" for="tab-set--5-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use complex numbers to facilitate writing polar coordinates</span>
<span class="n">c3</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Curve</span><span class="p">(</span><span class="mi">2</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">6</span><span class="p">),</span> <span class="n">relative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Elliptical arcs have syntax similar to gdstk.ellipse</span>
<span class="n">c3</span><span class="o">.</span><span class="n">arc</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">p3</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span><span class="n">c3</span><span class="o">.</span><span class="n">points</span><span class="p">())</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio" /><label class="tab-label" for="tab-set--5-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">example_curves2</span><span class="p">(</span><span class="n">Cell</span><span class="o">&amp;</span><span class="w"> </span><span class="n">out_cell</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Curve</span><span class="w"> </span><span class="n">c3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">    </span><span class="n">c3</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="mf">0.01</span><span class="p">);</span>
<span class="w">    </span><span class="n">c3</span><span class="p">.</span><span class="n">segment</span><span class="p">(</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">cplx_from_angle</span><span class="p">(</span><span class="n">M_PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">6</span><span class="p">),</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
<span class="w">    </span><span class="n">c3</span><span class="p">.</span><span class="n">arc</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">M_PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">M_PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>

<span class="w">    </span><span class="n">Polygon</span><span class="o">*</span><span class="w"> </span><span class="n">p3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Polygon</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Polygon</span><span class="p">));</span>
<span class="w">    </span><span class="n">p3</span><span class="o">-&gt;</span><span class="n">point_array</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">c3</span><span class="p">.</span><span class="n">point_array</span><span class="p">);</span>
<span class="w">    </span><span class="n">out_cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">p3</span><span class="p">);</span>
<span class="w">    </span><span class="n">c3</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<img alt="_images/curves_1.svg" class="align-center" src="_images/curves_1.svg" />
<p>Curves sections can be constructed as cubic, quadratic and general-degree
Bézier curves.  Additionally, a smooth interpolating curve can be calculated
with the method <a class="reference internal" href="geometry/gdstk.Curve.html#gdstk.Curve.interpolation" title="gdstk.Curve.interpolation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gdstk.Curve.interpolation()</span></code></a>, which has a number of
arguments to control the shape of the curve.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio" /><label class="tab-label" for="tab-set--6-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cubic Bezier curves can be easily created</span>
<span class="n">c4</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Curve</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="n">c4</span><span class="o">.</span><span class="n">cubic</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="c1"># Smooth continuation:</span>
<span class="n">c4</span><span class="o">.</span><span class="n">cubic_smooth</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="n">relative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Similarly for quadratic Bezier curves</span>
<span class="n">c4</span><span class="o">.</span><span class="n">quadratic</span><span class="p">([(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="n">relative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">c4</span><span class="o">.</span><span class="n">quadratic_smooth</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">relative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Smooth interpolating curve</span>
<span class="n">c4</span><span class="o">.</span><span class="n">interpolation</span><span class="p">([(</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="n">p4</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span><span class="n">c4</span><span class="o">.</span><span class="n">points</span><span class="p">())</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio" /><label class="tab-label" for="tab-set--6-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">example_curves3</span><span class="p">(</span><span class="n">Cell</span><span class="o">&amp;</span><span class="w"> </span><span class="n">out_cell</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Curve</span><span class="w"> </span><span class="n">c4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">    </span><span class="n">c4</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="mf">1e-3</span><span class="p">);</span>

<span class="w">    </span><span class="n">Vec2</span><span class="w"> </span><span class="n">points1</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">}};</span>
<span class="w">    </span><span class="n">c4</span><span class="p">.</span><span class="n">cubic</span><span class="p">({.</span><span class="n">capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">points1</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">points1</span><span class="p">},</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>

<span class="w">    </span><span class="n">Vec2</span><span class="w"> </span><span class="n">points2</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">}};</span>
<span class="w">    </span><span class="n">c4</span><span class="p">.</span><span class="n">cubic_smooth</span><span class="p">({.</span><span class="n">capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">points2</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">points2</span><span class="p">},</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>

<span class="w">    </span><span class="n">Vec2</span><span class="w"> </span><span class="n">points3</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">}};</span>
<span class="w">    </span><span class="n">c4</span><span class="p">.</span><span class="n">quadratic</span><span class="p">({.</span><span class="n">capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">points3</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">points3</span><span class="p">},</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>

<span class="w">    </span><span class="n">c4</span><span class="p">.</span><span class="n">quadratic_smooth</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>

<span class="w">    </span><span class="n">Vec2</span><span class="w"> </span><span class="n">points4</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.5</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">}};</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">angles</span><span class="p">[</span><span class="n">COUNT</span><span class="p">(</span><span class="n">points4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">angle_constraints</span><span class="p">[</span><span class="n">COUNT</span><span class="p">(</span><span class="n">points4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">    </span><span class="n">Vec2</span><span class="w"> </span><span class="n">tension</span><span class="p">[</span><span class="n">COUNT</span><span class="p">(</span><span class="n">points4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">}};</span>

<span class="w">    </span><span class="n">c4</span><span class="p">.</span><span class="n">interpolation</span><span class="p">({.</span><span class="n">capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">points4</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">points4</span><span class="p">},</span><span class="w"> </span><span class="n">angles</span><span class="p">,</span>
<span class="w">                     </span><span class="n">angle_constraints</span><span class="p">,</span><span class="w"> </span><span class="n">tension</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// The last point will coincide with the first (this can be checked at</span>
<span class="w">    </span><span class="c1">// runtime with the `closed` method), so we remove it.</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">c4</span><span class="p">.</span><span class="n">closed</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">c4</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">c4</span><span class="p">.</span><span class="n">point_array</span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">Polygon</span><span class="o">*</span><span class="w"> </span><span class="n">p4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Polygon</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Polygon</span><span class="p">));</span>
<span class="w">    </span><span class="n">p4</span><span class="o">-&gt;</span><span class="n">point_array</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">c4</span><span class="p">.</span><span class="n">point_array</span><span class="p">);</span>
<span class="w">    </span><span class="n">out_cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">p4</span><span class="p">);</span>
<span class="w">    </span><span class="n">c4</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<img alt="_images/curves_2.svg" class="align-center" src="_images/curves_2.svg" />
</section>
<section id="transformations">
<h3>Transformations<a class="headerlink" href="#transformations" title="Link to this heading"></a></h3>
<p>All polygons can be transformed through <a class="reference internal" href="geometry/gdstk.Polygon.html#gdstk.Polygon.translate" title="gdstk.Polygon.translate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gdstk.Polygon.translate()</span></code></a>,
<a class="reference internal" href="geometry/gdstk.Polygon.html#gdstk.Polygon.rotate" title="gdstk.Polygon.rotate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gdstk.Polygon.rotate()</span></code></a>, <a class="reference internal" href="geometry/gdstk.Polygon.html#gdstk.Polygon.scale" title="gdstk.Polygon.scale"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gdstk.Polygon.scale()</span></code></a>, and
<a class="reference internal" href="geometry/gdstk.Polygon.html#gdstk.Polygon.mirror" title="gdstk.Polygon.mirror"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gdstk.Polygon.mirror()</span></code></a>.  The transformations are applied in-place, i.e.,
no new polygons are created.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio" /><label class="tab-label" for="tab-set--7-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">poly</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">rectangle</span><span class="p">((</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">poly</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">poly</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio" /><label class="tab-label" for="tab-set--7-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">example_transformations</span><span class="p">(</span><span class="n">Cell</span><span class="o">&amp;</span><span class="w"> </span><span class="n">out_cell</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Polygon</span><span class="o">*</span><span class="w"> </span><span class="n">poly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Polygon</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Polygon</span><span class="p">));</span>
<span class="w">    </span><span class="o">*</span><span class="n">poly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rectangle</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="mi">-2</span><span class="p">},</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">poly</span><span class="o">-&gt;</span><span class="n">rotate</span><span class="p">(</span><span class="n">M_PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">});</span>
<span class="w">    </span><span class="n">poly</span><span class="o">-&gt;</span><span class="n">scale</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">},</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">});</span>
<span class="w">    </span><span class="n">out_cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">poly</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<img alt="_images/transformations.svg" class="align-center" src="_images/transformations.svg" />
</section>
<section id="layer-and-datatype">
<h3>Layer and Datatype<a class="headerlink" href="#layer-and-datatype" title="Link to this heading"></a></h3>
<p>All shapes are tagged with 2 properties: layer and data type (or text type in
the case of <a class="reference internal" href="library/gdstk.Label.html#gdstk.Label" title="gdstk.Label"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.Label</span></code></a>).  They are always 0 by default, but can be
any integer in the range from 0 to 255.</p>
<p>These properties have no predefined meaning.  It is up to the system using the
file to chose with to do with those tags.  For example, in the CMOS fabrication
process, each layer could represent a different lithography level.</p>
<p>In the example below, a single file stores different fabrication masks in
separate layer and data type configurations.  Python dictionaries are used to
simplify the assignment to each polygon.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio" /><label class="tab-label" for="tab-set--8-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Layer/datatype definitions for each step in the fabrication</span>
<span class="n">ld</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;full etch&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;layer&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;datatype&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
    <span class="s2">&quot;partial etch&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;layer&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;datatype&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
    <span class="s2">&quot;lift-off&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;layer&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;datatype&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">},</span>
<span class="p">}</span>

<span class="n">p1</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">rectangle</span><span class="p">((</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="o">**</span><span class="n">ld</span><span class="p">[</span><span class="s2">&quot;full etch&quot;</span><span class="p">])</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">rectangle</span><span class="p">((</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="o">**</span><span class="n">ld</span><span class="p">[</span><span class="s2">&quot;partial etch&quot;</span><span class="p">])</span>
<span class="n">p3</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">rectangle</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="o">**</span><span class="n">ld</span><span class="p">[</span><span class="s2">&quot;partial etch&quot;</span><span class="p">])</span>
<span class="n">p4</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">regular_polygon</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">**</span><span class="n">ld</span><span class="p">[</span><span class="s2">&quot;lift-off&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--8-input--2" name="tab-set--8" type="radio" /><label class="tab-label" for="tab-set--8-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">example_layerdatatype</span><span class="p">(</span><span class="n">Cell</span><span class="o">&amp;</span><span class="w"> </span><span class="n">out_cell</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Tag</span><span class="w"> </span><span class="n">t_full_etch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tag</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="w">    </span><span class="n">Tag</span><span class="w"> </span><span class="n">t_partial_etch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tag</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="w">    </span><span class="n">Tag</span><span class="w"> </span><span class="n">t_lift_off</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tag</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">);</span>

<span class="w">    </span><span class="n">Polygon</span><span class="o">*</span><span class="w"> </span><span class="n">poly</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">poly</span><span class="p">);</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="n">poly</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Polygon</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Polygon</span><span class="p">));</span>

<span class="w">    </span><span class="o">*</span><span class="n">poly</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rectangle</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">-3</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">},</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w"> </span><span class="n">t_full_etch</span><span class="p">);</span>
<span class="w">    </span><span class="o">*</span><span class="n">poly</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rectangle</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">-5</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">},</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">-3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w"> </span><span class="n">t_partial_etch</span><span class="p">);</span>
<span class="w">    </span><span class="o">*</span><span class="n">poly</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rectangle</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">},</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w"> </span><span class="n">t_partial_etch</span><span class="p">);</span>
<span class="w">    </span><span class="o">*</span><span class="n">poly</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">regular_polygon</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">t_lift_off</span><span class="p">);</span>

<span class="w">    </span><span class="n">out_cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">extend</span><span class="p">({.</span><span class="n">capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">poly</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poly</span><span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<img alt="_images/layer_and_datatype.svg" class="align-center" src="_images/layer_and_datatype.svg" />
</section>
</section>
<section id="references">
<span id="id3"></span><h2>References<a class="headerlink" href="#references" title="Link to this heading"></a></h2>
<p>References are responsible for the hierarchical structure of the layout.
Through references, the cell content can be reused in another cell (without
actually copying the whole geometry).  As an example, imagine the we are
designing an electronic circuit that uses hundreds of transistors, all with the
same shape.  We can draw the transistor just once and reference it throughout
the circuit, rotating or mirroring each instance as necessary.</p>
<p>Besides creating single references, it is also possible to create full 2D
arrays with a single entity, both using <a class="reference internal" href="library/gdstk.Reference.html#gdstk.Reference" title="gdstk.Reference"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.Reference</span></code></a>.  Both uses
are exemplified below.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--9-input--1" name="tab-set--9" type="radio" /><label class="tab-label" for="tab-set--9-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a cell with a component that is used repeatedly</span>
<span class="n">contact</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="s2">&quot;CONTACT&quot;</span><span class="p">)</span>
<span class="n">contact</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">)</span>

<span class="c1"># Create a cell with the complete device</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="s2">&quot;DEVICE&quot;</span><span class="p">)</span>
<span class="n">device</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cutout</span><span class="p">)</span>
<span class="c1"># Add 2 references to the component changing size and orientation</span>
<span class="n">ref1</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Reference</span><span class="p">(</span><span class="n">contact</span><span class="p">,</span> <span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">magnification</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">ref2</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Reference</span><span class="p">(</span><span class="n">contact</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">),</span> <span class="n">magnification</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">device</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ref1</span><span class="p">,</span> <span class="n">ref2</span><span class="p">)</span>

<span class="c1"># The final layout has several repetitions of the complete device</span>
<span class="n">main</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="s2">&quot;MAIN&quot;</span><span class="p">)</span>
<span class="n">main</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">gdstk</span><span class="o">.</span><span class="n">Reference</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--9-input--2" name="tab-set--9" type="radio" /><label class="tab-label" for="tab-set--9-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;gdstk/gdstk.hpp&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">gdstk</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">argv</span><span class="p">[])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Tag</span><span class="w"> </span><span class="n">t_full_etch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tag</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="w">    </span><span class="n">Tag</span><span class="w"> </span><span class="n">t_partial_etch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tag</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="w">    </span><span class="n">Tag</span><span class="w"> </span><span class="n">t_lift_off</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tag</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">);</span>

<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">lib_name</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;library&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">Library</span><span class="w"> </span><span class="n">lib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lib_name</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-6</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">precision</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-9</span><span class="p">};</span>

<span class="w">    </span><span class="c1">// CONTACT</span>

<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">contact_cell_name</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;CONTACT&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">Cell</span><span class="w"> </span><span class="n">contact_cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">contact_cell_name</span><span class="p">};</span>
<span class="w">    </span><span class="n">lib</span><span class="p">.</span><span class="n">cell_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">&amp;</span><span class="n">contact_cell</span><span class="p">);</span>

<span class="w">    </span><span class="n">Polygon</span><span class="w"> </span><span class="n">contact_poly</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="w">    </span><span class="n">contact_poly</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rectangle</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">-3</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">},</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w"> </span><span class="n">t_full_etch</span><span class="p">);</span>
<span class="w">    </span><span class="n">contact_poly</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rectangle</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">-5</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">},</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">-3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w"> </span><span class="n">t_partial_etch</span><span class="p">);</span>
<span class="w">    </span><span class="n">contact_poly</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rectangle</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">-3</span><span class="p">},</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w"> </span><span class="n">t_partial_etch</span><span class="p">);</span>
<span class="w">    </span><span class="n">contact_poly</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">regular_polygon</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">t_lift_off</span><span class="p">);</span>

<span class="w">    </span><span class="n">Polygon</span><span class="o">*</span><span class="w"> </span><span class="n">p</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">contact_poly</span><span class="p">,</span><span class="w"> </span><span class="n">contact_poly</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">contact_poly</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">contact_poly</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="p">};</span>
<span class="w">    </span><span class="n">contact_cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">extend</span><span class="p">({.</span><span class="n">capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">p</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">});</span>

<span class="w">    </span><span class="c1">// DEVICE</span>

<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">device_cell_name</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;DEVICE&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">Cell</span><span class="w"> </span><span class="n">device_cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device_cell_name</span><span class="p">};</span>
<span class="w">    </span><span class="n">lib</span><span class="p">.</span><span class="n">cell_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">&amp;</span><span class="n">device_cell</span><span class="p">);</span>

<span class="w">    </span><span class="n">Vec2</span><span class="w"> </span><span class="n">cutout_points</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span>
<span class="w">                            </span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">}};</span>
<span class="w">    </span><span class="n">Polygon</span><span class="w"> </span><span class="n">cutout_poly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">    </span><span class="n">cutout_poly</span><span class="p">.</span><span class="n">point_array</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span>
<span class="w">        </span><span class="p">{.</span><span class="n">capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">cutout_points</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cutout_points</span><span class="p">});</span>
<span class="w">    </span><span class="n">device_cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cutout_poly</span><span class="p">);</span>

<span class="w">    </span><span class="n">Reference</span><span class="w"> </span><span class="n">contact_ref1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ReferenceType</span><span class="o">::</span><span class="n">Cell</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">contact_cell</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">origin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mf">3.5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span>
<span class="w">        </span><span class="p">.</span><span class="n">magnification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25</span><span class="p">,</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="n">device_cell</span><span class="p">.</span><span class="n">reference_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">&amp;</span><span class="n">contact_ref1</span><span class="p">);</span>

<span class="w">    </span><span class="n">Reference</span><span class="w"> </span><span class="n">contact_ref2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ReferenceType</span><span class="o">::</span><span class="n">Cell</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">contact_cell</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">origin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mf">3.5</span><span class="p">},</span>
<span class="w">        </span><span class="p">.</span><span class="n">rotation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M_PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">magnification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25</span><span class="p">,</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="n">device_cell</span><span class="p">.</span><span class="n">reference_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">&amp;</span><span class="n">contact_ref2</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// MAIN</span>

<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">main_cell_name</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;MAIN&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">Cell</span><span class="w"> </span><span class="n">main_cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">main_cell_name</span><span class="p">};</span>
<span class="w">    </span><span class="n">lib</span><span class="p">.</span><span class="n">cell_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">&amp;</span><span class="n">main_cell</span><span class="p">);</span>

<span class="w">    </span><span class="n">Reference</span><span class="w"> </span><span class="n">device_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ReferenceType</span><span class="o">::</span><span class="n">Cell</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">device_cell</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">magnification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">repetition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">RepetitionType</span><span class="o">::</span><span class="n">Rectangular</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">}},</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="n">main_cell</span><span class="p">.</span><span class="n">reference_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">&amp;</span><span class="n">device_ref</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Output</span>

<span class="w">    </span><span class="n">lib</span><span class="p">.</span><span class="n">write_gds</span><span class="p">(</span><span class="s">&quot;references.gds&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">contact_poly</span><span class="p">);</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="n">contact_poly</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">cutout_poly</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">contact_cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">device_cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">device_cell</span><span class="p">.</span><span class="n">reference_array</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">main_cell</span><span class="p">.</span><span class="n">reference_array</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">lib</span><span class="p">.</span><span class="n">cell_array</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<img alt="_images/references.svg" class="align-center" src="_images/references.svg" />
</section>
<section id="paths">
<h2>Paths<a class="headerlink" href="#paths" title="Link to this heading"></a></h2>
<p>Besides polygons, the GDSII and OASIS formats define paths, witch are
<a class="reference external" href="https://en.wikipedia.org/wiki/Polygonal_chain">polygonal chains</a> with
associated width and end caps.  The width is a single number, constant
throughout the path, and the end caps can be flush, round (GDSII only), or
extended by a custom distance.</p>
<p>There is no specification for the joins between adjacent segments, so it is up
to the system using the file to specify those.  Usually the joins are straight
extensions of the path boundaries up to some beveling limit.  Gdstk also uses
this specification for the joins.</p>
<p>It is possible to circumvent all of the above limitations within Gdstk by
storing paths as polygons in the GDSII or OASIS file.  The disadvantage of this
solution is that other software will not be able to edit the geometry as paths,
since that information is lost.</p>
<p>The construction of paths (either GDSII/OASIS paths or polygonal paths) in
Gdstk is based on <a class="reference internal" href="geometry/gdstk.FlexPath.html#gdstk.FlexPath" title="gdstk.FlexPath"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.FlexPath</span></code></a> and <a class="reference internal" href="geometry/gdstk.RobustPath.html#gdstk.RobustPath" title="gdstk.RobustPath"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.RobustPath</span></code></a>.</p>
<section id="flexible-paths">
<h3>Flexible Paths<a class="headerlink" href="#flexible-paths" title="Link to this heading"></a></h3>
<p>The class <a class="reference internal" href="geometry/gdstk.FlexPath.html#gdstk.FlexPath" title="gdstk.FlexPath"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.FlexPath</span></code></a> is a mirror of <a class="reference internal" href="geometry/gdstk.Curve.html#gdstk.Curve" title="gdstk.Curve"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.Curve</span></code></a> before,
with additional features to facilitate path creation:</p>
<ul class="simple">
<li><p>all curve construction methods are available;</p></li>
<li><p>path width can be easily controlled throughout the path;</p></li>
<li><p>end caps and joins can be specified by the user;</p></li>
<li><p>straight segments can be automatically joined by circular arcs;</p></li>
<li><p>multiple parallel paths can be designed simultaneously;</p></li>
<li><p>spacing between parallel paths is arbitrary - the user specifies the offset
of each path individually.</p></li>
</ul>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--10-input--1" name="tab-set--10" type="radio" /><label class="tab-label" for="tab-set--10-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Path defined by a sequence of points and stored as a GDSII path</span>
<span class="n">fp1</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">FlexPath</span><span class="p">(</span>
    <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">simple_path</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Other construction methods can still be used</span>
<span class="n">fp1</span><span class="o">.</span><span class="n">interpolation</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">relative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Multiple parallel paths separated by 0.5 with different widths,</span>
<span class="c1"># end caps, and joins.  Because of the join specification, they</span>
<span class="c1"># cannot be stared as GDSII paths, only as polygons.</span>
<span class="n">fp2</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">FlexPath</span><span class="p">(</span>
    <span class="p">[(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span>
    <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span>
    <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">ends</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;extended&quot;</span><span class="p">,</span> <span class="s2">&quot;flush&quot;</span><span class="p">,</span> <span class="s2">&quot;round&quot;</span><span class="p">],</span>
    <span class="n">joins</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;bevel&quot;</span><span class="p">,</span> <span class="s2">&quot;miter&quot;</span><span class="p">,</span> <span class="s2">&quot;round&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">fp2</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">fp2</span><span class="o">.</span><span class="n">arc</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--10-input--2" name="tab-set--10" type="radio" /><label class="tab-label" for="tab-set--10-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">Cell</span><span class="o">*</span><span class="w"> </span><span class="nf">example_flexpath1</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Cell</span><span class="o">*</span><span class="w"> </span><span class="n">out_cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Cell</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Cell</span><span class="p">));</span>
<span class="w">    </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy_string</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="n">FlexPath</span><span class="o">*</span><span class="w"> </span><span class="n">fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">FlexPath</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">FlexPath</span><span class="p">));</span>
<span class="w">    </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">init</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">simple_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>

<span class="w">    </span><span class="n">Vec2</span><span class="w"> </span><span class="n">points1</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">}};</span>
<span class="w">    </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">segment</span><span class="p">({.</span><span class="n">capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">points1</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">points1</span><span class="p">},</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>

<span class="w">    </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">flexpath_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>

<span class="w">    </span><span class="n">fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">FlexPath</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">FlexPath</span><span class="p">));</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">widths</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4</span><span class="p">};</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">offsets</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">};</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">Tag</span><span class="w"> </span><span class="n">tags</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span>
<span class="w">    </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">init</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">widths</span><span class="p">,</span><span class="w"> </span><span class="n">offsets</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="n">tags</span><span class="p">);</span>

<span class="w">    </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">end_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EndType</span><span class="o">::</span><span class="n">HalfWidth</span><span class="p">;</span>
<span class="w">    </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">join_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JoinType</span><span class="o">::</span><span class="n">Bevel</span><span class="p">;</span>

<span class="w">    </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">elements</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">end_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EndType</span><span class="o">::</span><span class="n">Flush</span><span class="p">;</span>
<span class="w">    </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">elements</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">join_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JoinType</span><span class="o">::</span><span class="n">Miter</span><span class="p">;</span>

<span class="w">    </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">elements</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">end_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EndType</span><span class="o">::</span><span class="n">Round</span><span class="p">;</span>
<span class="w">    </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">elements</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">join_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JoinType</span><span class="o">::</span><span class="n">Round</span><span class="p">;</span>

<span class="w">    </span><span class="n">Vec2</span><span class="w"> </span><span class="n">points2</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">}};</span>
<span class="w">    </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">segment</span><span class="p">({.</span><span class="n">capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">points2</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">points2</span><span class="p">},</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>

<span class="w">    </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">arc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">M_PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">M_PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="w">    </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">arc</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">M_PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mf">1.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">M_PI</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">flexpath_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">out_cell</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<img alt="_images/flexible_paths.svg" class="align-center" src="_images/flexible_paths.svg" />
<p>The corner type “circular bend” (together with the <cite>bend_radius</cite> argument) can
be used to automatically curve the path.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--11-input--1" name="tab-set--11" type="radio" /><label class="tab-label" for="tab-set--11-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Path created with automatic bends of radius 5</span>
<span class="n">points</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">)]</span>
<span class="n">fp3</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">FlexPath</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">bend_radius</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">simple_path</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Same path, generated with natural joins, for comparison</span>
<span class="n">fp4</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">FlexPath</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">simple_path</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--11-input--2" name="tab-set--11" type="radio" /><label class="tab-label" for="tab-set--11-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">Cell</span><span class="o">*</span><span class="w"> </span><span class="nf">example_flexpath2</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Cell</span><span class="o">*</span><span class="w"> </span><span class="n">out_cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Cell</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Cell</span><span class="p">));</span>
<span class="w">    </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy_string</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="n">Vec2</span><span class="w"> </span><span class="n">points</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">18</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">}};</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">FlexPath</span><span class="o">*</span><span class="w"> </span><span class="n">fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">FlexPath</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">FlexPath</span><span class="p">));</span>
<span class="w">        </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">init</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">simple_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">bend_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BendType</span><span class="o">::</span><span class="n">Circular</span><span class="p">;</span>
<span class="w">            </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">bend_radius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tag</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">segment</span><span class="p">({.</span><span class="n">capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">points</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">points</span><span class="p">},</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>
<span class="w">        </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">flexpath_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">out_cell</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<img alt="_images/flexible_paths_2.svg" class="align-center" src="_images/flexible_paths_2.svg" />
<p>Width and offset variations are possible throughout the path.  Changes are
linearly tapered in the path section they are defined.  Note that, because
width changes are not possible for GDSII/OASIS paths, they will be stored as
polygonal objects.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--12-input--1" name="tab-set--12" type="radio" /><label class="tab-label" for="tab-set--12-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Straight segment showing the possibility of width and offset changes</span>
<span class="n">fp5</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">FlexPath</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fp5</span><span class="o">.</span><span class="n">horizontal</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fp5</span><span class="o">.</span><span class="n">horizontal</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mf">1.8</span><span class="p">)</span>
<span class="n">fp5</span><span class="o">.</span><span class="n">horizontal</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--12-input--2" name="tab-set--12" type="radio" /><label class="tab-label" for="tab-set--12-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">Cell</span><span class="o">*</span><span class="w"> </span><span class="nf">example_flexpath3</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Cell</span><span class="o">*</span><span class="w"> </span><span class="n">out_cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Cell</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Cell</span><span class="p">));</span>
<span class="w">    </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy_string</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">widths</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">};</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">offsets</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mf">-0.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">};</span>
<span class="w">    </span><span class="n">Tag</span><span class="w"> </span><span class="n">tags</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">};</span>
<span class="w">    </span><span class="n">FlexPath</span><span class="o">*</span><span class="w"> </span><span class="n">fp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">FlexPath</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">FlexPath</span><span class="p">));</span>
<span class="w">    </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">init</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">widths</span><span class="p">,</span><span class="w"> </span><span class="n">offsets</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="n">tags</span><span class="p">);</span>

<span class="w">    </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">horizontal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>

<span class="w">    </span><span class="n">widths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.8</span><span class="p">;</span>
<span class="w">    </span><span class="n">widths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.8</span><span class="p">;</span>
<span class="w">    </span><span class="n">offsets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.9</span><span class="p">;</span>
<span class="w">    </span><span class="n">offsets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.9</span><span class="p">;</span>
<span class="w">    </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">horizontal</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">widths</span><span class="p">,</span><span class="w"> </span><span class="n">offsets</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>

<span class="w">    </span><span class="n">fp</span><span class="o">-&gt;</span><span class="n">horizontal</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>

<span class="w">    </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">flexpath_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">out_cell</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<img alt="_images/flexible_paths_3.svg" class="align-center" src="_images/flexible_paths_3.svg" />
</section>
<section id="robust-paths">
<h3>Robust Paths<a class="headerlink" href="#robust-paths" title="Link to this heading"></a></h3>
<p>In some situations, <a class="reference internal" href="geometry/gdstk.FlexPath.html#gdstk.FlexPath" title="gdstk.FlexPath"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.FlexPath</span></code></a> is unable to properly calculate all
the joins.  This often happens when the width or offset of the path is
relatively large with respect to the length of the segments being joined.
Curves that meet other curves or segments at sharp angles are a typical example
where this often happens.</p>
<p>The class <a class="reference internal" href="geometry/gdstk.RobustPath.html#gdstk.RobustPath" title="gdstk.RobustPath"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.RobustPath</span></code></a> can be used in such scenarios where curved
sections are expected to meet at sharp angles.  The drawbacks of using
<a class="reference internal" href="geometry/gdstk.RobustPath.html#gdstk.RobustPath" title="gdstk.RobustPath"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.RobustPath</span></code></a> are the extra computational resources required to
calculate all joins and the impossibility of specifying joins.  The advantages
are, as mentioned earlier, more robustness when generating the final geometry,
and freedom to use custom functions to parameterize the widths or offsets of
the paths.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--13-input--1" name="tab-set--13" type="radio" /><label class="tab-label" for="tab-set--13-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create 4 parallel paths in different layers</span>
<span class="n">rp</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">RobustPath</span><span class="p">(</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">ends</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;extended&quot;</span><span class="p">,</span> <span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="s2">&quot;flush&quot;</span><span class="p">,</span> <span class="s2">&quot;flush&quot;</span><span class="p">],</span>
    <span class="n">layer</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">rp</span><span class="o">.</span><span class="n">segment</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">))</span>
<span class="n">rp</span><span class="o">.</span><span class="n">segment</span><span class="p">(</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="n">width</span><span class="o">=</span><span class="p">[</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">16</span> <span class="o">*</span> <span class="n">u</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">u</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">offset</span><span class="o">=</span><span class="p">[</span>
        <span class="mi">0</span><span class="p">,</span>
        <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">u</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">12</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">u</span><span class="p">),</span>
        <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">u</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">u</span><span class="p">),</span>
        <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">u</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">u</span><span class="p">),</span>
    <span class="p">],</span>
<span class="p">)</span>
<span class="n">rp</span><span class="o">.</span><span class="n">segment</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">rp</span><span class="o">.</span><span class="n">interpolation</span><span class="p">(</span>
    <span class="p">[(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">)],</span>
    <span class="n">angles</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="p">],</span>
    <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">offset</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">rp</span><span class="o">.</span><span class="n">parametric</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="mi">4</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">u</span><span class="p">),</span> <span class="mi">45</span> <span class="o">*</span> <span class="n">u</span><span class="p">)),</span>
    <span class="n">offset</span><span class="o">=</span><span class="p">[</span>
        <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">24</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">u</span><span class="p">),</span>
        <span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">24</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">u</span><span class="p">),</span>
        <span class="o">-</span><span class="mf">0.75</span><span class="p">,</span>
        <span class="mf">0.75</span><span class="p">,</span>
    <span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--13-input--2" name="tab-set--13" type="radio" /><label class="tab-label" for="tab-set--13-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;gdstk/gdstk.hpp&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">gdstk</span><span class="p">;</span>

<span class="kt">double</span><span class="w"> </span><span class="nf">parametric1</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>

<span class="kt">double</span><span class="w"> </span><span class="nf">parametric2</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">cos</span><span class="p">(</span><span class="mi">12</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">M_PI</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>

<span class="kt">double</span><span class="w"> </span><span class="nf">parametric3</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">-1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>

<span class="kt">double</span><span class="w"> </span><span class="nf">parametric4</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">u</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>

<span class="kt">double</span><span class="w"> </span><span class="nf">parametric5</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">-0.25</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">cos</span><span class="p">(</span><span class="mi">24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">M_PI</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>

<span class="kt">double</span><span class="w"> </span><span class="nf">parametric6</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">0.25</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">cos</span><span class="p">(</span><span class="mi">24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">M_PI</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u</span><span class="p">);</span><span class="w"> </span><span class="p">}</span>

<span class="n">Vec2</span><span class="w"> </span><span class="nf">parametric7</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="mi">6</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">M_PI</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u</span><span class="p">),</span><span class="w"> </span><span class="mi">45</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">u</span><span class="p">};</span><span class="w"> </span><span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">argv</span><span class="p">[])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">widths</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">};</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">offsets</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">};</span>
<span class="w">    </span><span class="n">Tag</span><span class="w"> </span><span class="n">tags</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">make_tag</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">make_tag</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">make_tag</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">make_tag</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)};</span>
<span class="w">    </span><span class="n">RobustPath</span><span class="w"> </span><span class="n">rp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">    </span><span class="n">rp</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">50</span><span class="p">},</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">widths</span><span class="p">,</span><span class="w"> </span><span class="n">offsets</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">tags</span><span class="p">);</span>
<span class="w">    </span><span class="n">rp</span><span class="p">.</span><span class="n">scale_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="n">rp</span><span class="p">.</span><span class="n">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">end_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EndType</span><span class="o">::</span><span class="n">HalfWidth</span><span class="p">;</span>
<span class="w">    </span><span class="n">rp</span><span class="p">.</span><span class="n">elements</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">end_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EndType</span><span class="o">::</span><span class="n">Round</span><span class="p">;</span>
<span class="w">    </span><span class="n">rp</span><span class="p">.</span><span class="n">elements</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">end_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EndType</span><span class="o">::</span><span class="n">Flush</span><span class="p">;</span>
<span class="w">    </span><span class="n">rp</span><span class="p">.</span><span class="n">elements</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="n">end_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EndType</span><span class="o">::</span><span class="n">Flush</span><span class="p">;</span>

<span class="w">    </span><span class="n">rp</span><span class="p">.</span><span class="n">segment</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">45</span><span class="p">},</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>

<span class="w">    </span><span class="n">Interpolation</span><span class="w"> </span><span class="n">width1</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Parametric</span><span class="p">},</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Constant</span><span class="p">},</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Constant</span><span class="p">},</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Constant</span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="n">width1</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">function</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parametric1</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">width1</span><span class="p">);</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">width1</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rp</span><span class="p">.</span><span class="n">elements</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">end_width</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">Interpolation</span><span class="w"> </span><span class="n">offset1</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Constant</span><span class="p">},</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Parametric</span><span class="p">},</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Parametric</span><span class="p">},</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Parametric</span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="n">offset1</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">offset1</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">function</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parametric2</span><span class="p">;</span>
<span class="w">    </span><span class="n">offset1</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">function</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parametric3</span><span class="p">;</span>
<span class="w">    </span><span class="n">offset1</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="n">function</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parametric4</span><span class="p">;</span>
<span class="w">    </span><span class="n">rp</span><span class="p">.</span><span class="n">segment</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">},</span><span class="w"> </span><span class="n">width1</span><span class="p">,</span><span class="w"> </span><span class="n">offset1</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>

<span class="w">    </span><span class="n">rp</span><span class="p">.</span><span class="n">segment</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>

<span class="w">    </span><span class="n">Vec2</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">};</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">angles</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">M_PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">};</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">angle_constraints</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">};</span>
<span class="w">    </span><span class="n">Vec2</span><span class="w"> </span><span class="n">tension</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">}};</span>
<span class="w">    </span><span class="n">Interpolation</span><span class="w"> </span><span class="n">width2</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Linear</span><span class="p">},</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Linear</span><span class="p">},</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Linear</span><span class="p">},</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Linear</span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="n">Interpolation</span><span class="w"> </span><span class="n">offset2</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Linear</span><span class="p">},</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Linear</span><span class="p">},</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Linear</span><span class="p">},</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Linear</span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">width2</span><span class="p">);</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">width2</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">initial_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rp</span><span class="p">.</span><span class="n">elements</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">end_width</span><span class="p">;</span>
<span class="w">        </span><span class="n">width2</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">final_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>
<span class="w">        </span><span class="n">offset2</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">initial_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rp</span><span class="p">.</span><span class="n">elements</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">end_offset</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">offset2</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">final_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.25</span><span class="p">;</span>
<span class="w">    </span><span class="n">offset2</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">final_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25</span><span class="p">;</span>
<span class="w">    </span><span class="n">offset2</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">final_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.75</span><span class="p">;</span>
<span class="w">    </span><span class="n">offset2</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="n">final_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.75</span><span class="p">;</span>
<span class="w">    </span><span class="n">rp</span><span class="p">.</span><span class="n">interpolation</span><span class="p">({.</span><span class="n">capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">point</span><span class="p">},</span><span class="w"> </span><span class="n">angles</span><span class="p">,</span><span class="w"> </span><span class="n">angle_constraints</span><span class="p">,</span>
<span class="w">                     </span><span class="n">tension</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="n">width2</span><span class="p">,</span><span class="w"> </span><span class="n">offset2</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>

<span class="w">    </span><span class="n">Interpolation</span><span class="w"> </span><span class="n">offset3</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Parametric</span><span class="p">},</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Parametric</span><span class="p">},</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Constant</span><span class="p">},</span>
<span class="w">        </span><span class="p">{.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InterpolationType</span><span class="o">::</span><span class="n">Constant</span><span class="p">},</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="n">offset3</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">function</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parametric5</span><span class="p">;</span>
<span class="w">    </span><span class="n">offset3</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">function</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parametric6</span><span class="p">;</span>
<span class="w">    </span><span class="n">offset3</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-0.75</span><span class="p">;</span>
<span class="w">    </span><span class="n">offset3</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.75</span><span class="p">;</span>
<span class="w">    </span><span class="n">rp</span><span class="p">.</span><span class="n">parametric</span><span class="p">(</span><span class="n">parametric7</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">offset3</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>

<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">robustpath_cell_name</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;RobustPath&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">Cell</span><span class="w"> </span><span class="n">robustpath_cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">robustpath_cell_name</span><span class="p">};</span>
<span class="w">    </span><span class="n">robustpath_cell</span><span class="p">.</span><span class="n">robustpath_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">&amp;</span><span class="n">rp</span><span class="p">);</span>

<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">lib_name</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Paths&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">Library</span><span class="w"> </span><span class="n">lib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lib_name</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-6</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">precision</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-9</span><span class="p">};</span>
<span class="w">    </span><span class="n">lib</span><span class="p">.</span><span class="n">cell_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">&amp;</span><span class="n">robustpath_cell</span><span class="p">);</span>

<span class="w">    </span><span class="n">lib</span><span class="p">.</span><span class="n">write_gds</span><span class="p">(</span><span class="s">&quot;robustpaths.gds&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="n">rp</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">robustpath_cell</span><span class="p">.</span><span class="n">robustpath_array</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">lib</span><span class="p">.</span><span class="n">cell_array</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<img alt="_images/robust_paths.svg" class="align-center" src="_images/robust_paths.svg" />
<p>Note that, analogously to <a class="reference internal" href="geometry/gdstk.FlexPath.html#gdstk.FlexPath" title="gdstk.FlexPath"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.FlexPath</span></code></a>, <a class="reference internal" href="geometry/gdstk.RobustPath.html#gdstk.RobustPath" title="gdstk.RobustPath"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.RobustPath</span></code></a>
can be stored as a GDSII/OASIS path as long as its width is kept constant.</p>
</section>
</section>
<section id="text">
<h2>Text<a class="headerlink" href="#text" title="Link to this heading"></a></h2>
<p>In the context of a GDSII/OASIS file, text is supported in the form of labels,
which are ASCII annotations placed somewhere in the geometry of a given cell.
Similar to polygons, labels are tagged with layer and text type values (text
type is the label equivalent of the polygon data type).  They are supported by
the class <a class="reference internal" href="library/gdstk.Label.html#gdstk.Label" title="gdstk.Label"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.Label</span></code></a>.</p>
<p>Additionally, Gdstk offers the possibility of creating text as polygons to be
included with the geometry.  The function <a class="reference internal" href="geometry/gdstk.text.html#gdstk.text" title="gdstk.text"><code class="xref py py-func docutils literal notranslate"><span class="pre">gdstk.text()</span></code></a> creates polygonal
text that can be used in the same way as any other polygons in Gdstk.  The font
used to render the characters contains only horizontal and vertical edges,
which is important for some laser writing systems.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--14-input--1" name="tab-set--14" type="radio" /><label class="tab-label" for="tab-set--14-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Label centered at (1, 3)</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="s2">&quot;Sample label&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">texttype</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Horizontal text with height 2.25</span>
<span class="n">htext</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;12345&quot;</span><span class="p">,</span> <span class="mf">2.25</span><span class="p">,</span> <span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Vertical text with height 1.5</span>
<span class="n">vtext</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;ABC&quot;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="p">(</span><span class="mf">10.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">vertical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">rect</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">layer</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--14-input--2" name="tab-set--14" type="radio" /><label class="tab-label" for="tab-set--14-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;gdstk/gdstk.hpp&gt;</span>

<span class="k">using</span><span class="w"> </span><span class="k">namespace</span><span class="w"> </span><span class="nn">gdstk</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">argv</span><span class="p">[])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">lib_name</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Text&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">Library</span><span class="w"> </span><span class="n">lib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lib_name</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-6</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">precision</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-9</span><span class="p">};</span>

<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">text_cell_name</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Text&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">Cell</span><span class="w"> </span><span class="n">text_cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">text_cell_name</span><span class="p">};</span>
<span class="w">    </span><span class="n">lib</span><span class="p">.</span><span class="n">cell_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">&amp;</span><span class="n">text_cell</span><span class="p">);</span>

<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">label_text</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Sample label&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">Label</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">.</span><span class="n">tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tag</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span>
<span class="w">        </span><span class="p">.</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">label_text</span><span class="p">,</span>
<span class="w">        </span><span class="p">.</span><span class="n">origin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span>
<span class="w">        </span><span class="p">.</span><span class="n">magnification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">    </span><span class="n">text_cell</span><span class="p">.</span><span class="n">label_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">&amp;</span><span class="n">label</span><span class="p">);</span>

<span class="w">    </span><span class="n">Array</span><span class="o">&lt;</span><span class="n">Polygon</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">all_text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">    </span><span class="n">text</span><span class="p">(</span><span class="s">&quot;12345&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">2.25</span><span class="p">,</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mf">0.25</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">all_text</span><span class="p">);</span>
<span class="w">    </span><span class="n">text</span><span class="p">(</span><span class="s">&quot;ABC&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">1.5</span><span class="p">,</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mf">10.5</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">},</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">all_text</span><span class="p">);</span>
<span class="w">    </span><span class="n">text_cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">all_text</span><span class="p">);</span>

<span class="w">    </span><span class="n">Polygon</span><span class="w"> </span><span class="n">rect</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rectangle</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span><span class="w"> </span><span class="n">make_tag</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">));</span>
<span class="w">    </span><span class="n">text_cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="o">&amp;</span><span class="n">rect</span><span class="p">);</span>

<span class="w">    </span><span class="n">lib</span><span class="p">.</span><span class="n">write_gds</span><span class="p">(</span><span class="s">&quot;text.gds&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">all_text</span><span class="p">.</span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">all_text</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">clear</span><span class="p">();</span>
<span class="w">        </span><span class="n">free_allocation</span><span class="p">(</span><span class="n">all_text</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">all_text</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">rect</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">text_cell</span><span class="p">.</span><span class="n">label_array</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">text_cell</span><span class="p">.</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">lib</span><span class="p">.</span><span class="n">cell_array</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<img alt="_images/text1.svg" class="align-center" src="_images/text1.svg" />
</section>
<section id="geometry-operations">
<h2>Geometry Operations<a class="headerlink" href="#geometry-operations" title="Link to this heading"></a></h2>
<p>Gdstk offers a number of functions and methods to modify existing geometry.
The most useful operations include <a class="reference internal" href="geometry/gdstk.boolean.html#gdstk.boolean" title="gdstk.boolean"><code class="xref py py-func docutils literal notranslate"><span class="pre">gdstk.boolean()</span></code></a>, <a class="reference internal" href="geometry/gdstk.slice.html#gdstk.slice" title="gdstk.slice"><code class="xref py py-func docutils literal notranslate"><span class="pre">gdstk.slice()</span></code></a>,
<a class="reference internal" href="geometry/gdstk.offset.html#gdstk.offset" title="gdstk.offset"><code class="xref py py-func docutils literal notranslate"><span class="pre">gdstk.offset()</span></code></a>, and <a class="reference internal" href="geometry/gdstk.Polygon.html#gdstk.Polygon.fillet" title="gdstk.Polygon.fillet"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gdstk.Polygon.fillet()</span></code></a>.</p>
<section id="boolean-operations">
<h3>Boolean Operations<a class="headerlink" href="#boolean-operations" title="Link to this heading"></a></h3>
<p>Boolean operations (<a class="reference internal" href="geometry/gdstk.boolean.html#gdstk.boolean" title="gdstk.boolean"><code class="xref py py-func docutils literal notranslate"><span class="pre">gdstk.boolean()</span></code></a>) can be performed on polygons, paths
and whole cells.  Four operations are defined: union (“or”), intersection
(“and”), subtraction (“not”), and symmetric difference (“xor”).  They can be
computationally expensive, so it is usually advisable to avoid using boolean
operations whenever possible.  If they are necessary, keeping the number of
vertices is all polygons as low as possible also helps.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--15-input--1" name="tab-set--15" type="radio" /><label class="tab-label" for="tab-set--15-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create some text</span>
<span class="n">text</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;GDSTK&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="c1"># Create a rectangle extending the text&#39;s bounding box by 1</span>
<span class="n">rect</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">rectangle</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">9</span> <span class="o">/</span> <span class="mi">16</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Subtract the text from the rectangle</span>
<span class="n">inv</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">boolean</span><span class="p">(</span><span class="n">rect</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="s2">&quot;not&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--15-input--2" name="tab-set--15" type="radio" /><label class="tab-label" for="tab-set--15-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">Cell</span><span class="o">*</span><span class="w"> </span><span class="nf">example_boolean</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Cell</span><span class="o">*</span><span class="w"> </span><span class="n">out_cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Cell</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Cell</span><span class="p">));</span>
<span class="w">    </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy_string</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="n">Array</span><span class="o">&lt;</span><span class="n">Polygon</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">txt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">    </span><span class="n">text</span><span class="p">(</span><span class="s">&quot;GDSTK&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">txt</span><span class="p">);</span>

<span class="w">    </span><span class="n">Polygon</span><span class="w"> </span><span class="n">rect</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rectangle</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">},</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>

<span class="w">    </span><span class="n">boolean</span><span class="p">(</span><span class="n">rect</span><span class="p">,</span><span class="w"> </span><span class="n">txt</span><span class="p">,</span><span class="w"> </span><span class="n">Operation</span><span class="o">::</span><span class="n">Not</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">polygon_array</span><span class="p">);</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">txt</span><span class="p">.</span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">txt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">clear</span><span class="p">();</span>
<span class="w">        </span><span class="n">free_allocation</span><span class="p">(</span><span class="n">txt</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">txt</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">rect</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">out_cell</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<img alt="_images/boolean_operations.svg" class="align-center" src="_images/boolean_operations.svg" />
</section>
<section id="slice-operation">
<h3>Slice Operation<a class="headerlink" href="#slice-operation" title="Link to this heading"></a></h3>
<p>As the name indicates, a slice operation subdivides a set of polygons along
horizontal or vertical cut lines.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--16-input--1" name="tab-set--16" type="radio" /><label class="tab-label" for="tab-set--16-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ring1</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">ellipse</span><span class="p">((</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">6</span><span class="p">,</span> <span class="n">inner_radius</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ring2</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">ellipse</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">6</span><span class="p">,</span> <span class="n">inner_radius</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ring3</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">ellipse</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">6</span><span class="p">,</span> <span class="n">inner_radius</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># Slice the first ring across x=-3, the second ring across x=-3</span>
<span class="c1"># and x=3, and the third ring across x=3</span>
<span class="n">slices1</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">ring1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">slices2</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">ring2</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">slices3</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">ring3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>

<span class="n">slices</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span><span class="s2">&quot;SLICES&quot;</span><span class="p">)</span>

<span class="c1"># Keep only the left side of slices1, the center part of slices2</span>
<span class="c1"># and the right side of slices3</span>
<span class="n">slices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">slices1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">slices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">slices2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">slices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">*</span><span class="n">slices3</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--16-input--2" name="tab-set--16" type="radio" /><label class="tab-label" for="tab-set--16-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">Cell</span><span class="o">*</span><span class="w"> </span><span class="nf">example_slice</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Cell</span><span class="o">*</span><span class="w"> </span><span class="n">out_cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Cell</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Cell</span><span class="p">));</span>
<span class="w">    </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy_string</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="n">Polygon</span><span class="w"> </span><span class="n">ring</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="w">    </span><span class="n">ring</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ellipse</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">-6</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">ring</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ellipse</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">ring</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ellipse</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>

<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">-3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">};</span>
<span class="w">    </span><span class="n">Array</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">cuts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{.</span><span class="n">capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">};</span>
<span class="w">    </span><span class="n">Array</span><span class="o">&lt;</span><span class="n">Polygon</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">    </span><span class="n">slice</span><span class="p">(</span><span class="n">ring</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">cuts</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span>
<span class="w">    </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">clear</span><span class="p">();</span>
<span class="w">        </span><span class="n">free_allocation</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>

<span class="w">    </span><span class="n">cuts</span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="n">slice</span><span class="p">(</span><span class="n">ring</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">cuts</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span>
<span class="w">    </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">clear</span><span class="p">();</span>
<span class="w">        </span><span class="n">free_allocation</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">clear</span><span class="p">();</span>
<span class="w">        </span><span class="n">free_allocation</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>

<span class="w">    </span><span class="n">cuts</span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">cuts</span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">slice</span><span class="p">(</span><span class="n">ring</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">cuts</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span>
<span class="w">    </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">clear</span><span class="p">();</span>
<span class="w">        </span><span class="n">free_allocation</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>

<span class="w">    </span><span class="n">ring</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">ring</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">ring</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">clear</span><span class="p">();</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">out_cell</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<img alt="_images/slice_operation.svg" class="align-center" src="_images/slice_operation.svg" />
</section>
<section id="offset-operation">
<h3>Offset Operation<a class="headerlink" href="#offset-operation" title="Link to this heading"></a></h3>
<p>The function <a class="reference internal" href="geometry/gdstk.offset.html#gdstk.offset" title="gdstk.offset"><code class="xref py py-func docutils literal notranslate"><span class="pre">gdstk.offset()</span></code></a> dilates or erodes polygons by a fixed amount.
It can operate on individual polygons or sets of them, in which case it may be
necessary to set <code class="docutils literal notranslate"><span class="pre">use_union</span> <span class="pre">=</span> <span class="pre">True</span></code> to remove the impact of inner edges.  The
same is valid for polygons with holes.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--17-input--1" name="tab-set--17" type="radio" /><label class="tab-label" for="tab-set--17-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rect1</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">rectangle</span><span class="p">((</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">rect2</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">rectangle</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># Erosion: because we set `use_union=True`, the inner boundaries have no effect</span>
<span class="n">outer</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">offset</span><span class="p">([</span><span class="n">rect1</span><span class="p">,</span> <span class="n">rect2</span><span class="p">],</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">use_union</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--17-input--2" name="tab-set--17" type="radio" /><label class="tab-label" for="tab-set--17-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">Cell</span><span class="o">*</span><span class="w"> </span><span class="nf">example_offset</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Cell</span><span class="o">*</span><span class="w"> </span><span class="n">out_cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Cell</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Cell</span><span class="p">));</span>
<span class="w">    </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy_string</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="n">Polygon</span><span class="o">*</span><span class="w"> </span><span class="n">rect</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Polygon</span><span class="o">*</span><span class="p">)</span><span class="n">allocate</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Polygon</span><span class="p">));</span>
<span class="w">    </span><span class="o">*</span><span class="n">rect</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rectangle</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">-4</span><span class="p">,</span><span class="w"> </span><span class="mi">-4</span><span class="p">},</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">rect</span><span class="p">);</span>

<span class="w">    </span><span class="n">rect</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Polygon</span><span class="o">*</span><span class="p">)</span><span class="n">allocate</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Polygon</span><span class="p">));</span>
<span class="w">    </span><span class="o">*</span><span class="n">rect</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rectangle</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">},</span><span class="w"> </span><span class="n">Vec2</span><span class="p">{</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">},</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">rect</span><span class="p">);</span>

<span class="w">    </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">count</span><span class="p">;</span>
<span class="w">    </span><span class="n">offset</span><span class="p">(</span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">polygon_array</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.5</span><span class="p">,</span><span class="w"> </span><span class="n">OffsetJoin</span><span class="o">::</span><span class="n">Miter</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1000</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span>
<span class="w">           </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">polygon_array</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">start</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">polygon_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">tag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_tag</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">out_cell</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<img alt="_images/offset_operation.svg" class="align-center" src="_images/offset_operation.svg" />
</section>
<section id="fillet-operation">
<h3>Fillet Operation<a class="headerlink" href="#fillet-operation" title="Link to this heading"></a></h3>
<p>The method <a class="reference internal" href="geometry/gdstk.Polygon.html#gdstk.Polygon.fillet" title="gdstk.Polygon.fillet"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gdstk.Polygon.fillet()</span></code></a> can be used to round polygon corners.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--18-input--1" name="tab-set--18" type="radio" /><label class="tab-label" for="tab-set--18-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">flexpath</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">FlexPath</span><span class="p">([(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">)],</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">filleted_path</span> <span class="o">=</span> <span class="n">flexpath</span><span class="o">.</span><span class="n">to_polygons</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">filleted_path</span><span class="o">.</span><span class="n">fillet</span><span class="p">(</span><span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--18-input--2" name="tab-set--18" type="radio" /><label class="tab-label" for="tab-set--18-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">Cell</span><span class="o">*</span><span class="w"> </span><span class="nf">example_fillet</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Cell</span><span class="o">*</span><span class="w"> </span><span class="n">out_cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Cell</span><span class="o">*</span><span class="p">)</span><span class="n">allocate_clear</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">Cell</span><span class="p">));</span>
<span class="w">    </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">copy_string</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>

<span class="w">    </span><span class="n">FlexPath</span><span class="w"> </span><span class="n">flexpath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">    </span><span class="n">flexpath</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">Vec2</span><span class="p">{</span><span class="mi">-8</span><span class="p">,</span><span class="w"> </span><span class="mi">-4</span><span class="p">},</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">Vec2</span><span class="w"> </span><span class="n">points</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">-4</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">}};</span>
<span class="w">    </span><span class="n">flexpath</span><span class="p">.</span><span class="n">segment</span><span class="p">({.</span><span class="n">capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">COUNT</span><span class="p">(</span><span class="n">points</span><span class="p">),</span><span class="w"> </span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">points</span><span class="p">},</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">);</span>

<span class="w">    </span><span class="n">Array</span><span class="o">&lt;</span><span class="n">Polygon</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">poly_array</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">    </span><span class="n">flexpath</span><span class="p">.</span><span class="n">to_polygons</span><span class="p">(</span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">poly_array</span><span class="p">);</span>
<span class="w">    </span><span class="n">flexpath</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>

<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.5</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">poly_array</span><span class="p">.</span><span class="n">count</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">        </span><span class="n">poly_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">fillet</span><span class="p">({.</span><span class="n">capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">items</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">r</span><span class="p">},</span><span class="w"> </span><span class="mf">0.01</span><span class="p">);</span>

<span class="w">    </span><span class="n">out_cell</span><span class="o">-&gt;</span><span class="n">polygon_array</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">poly_array</span><span class="p">);</span>
<span class="w">    </span><span class="n">poly_array</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">out_cell</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<img alt="_images/fillet_operation.svg" class="align-center" src="_images/fillet_operation.svg" />
</section>
</section>
<section id="gdsii-oasis-library">
<h2>GDSII/OASIS Library<a class="headerlink" href="#gdsii-oasis-library" title="Link to this heading"></a></h2>
<p>All the information used to create a GDSII/OASIS file is kept within an
instance of <a class="reference internal" href="library/gdstk.Library.html#gdstk.Library" title="gdstk.Library"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.Library</span></code></a>.  Besides all the geometric and hierarchical
information, this class also holds a name and the units for all entities.  The
name can be any ASCII string — it is simply stored in the file and has no other
purpose in Gdstk.  The units require some attention because they can impact the
resolution of the polygons in the library when written to a file.</p>
<section id="a-note-about-units">
<span id="about-units"></span><h3>A Note About Units<a class="headerlink" href="#a-note-about-units" title="Link to this heading"></a></h3>
<p>Two values are defined when creating a <a class="reference internal" href="library/gdstk.Library.html#gdstk.Library" title="gdstk.Library"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.Library</span></code></a>: <code class="docutils literal notranslate"><span class="pre">unit</span></code> and
<code class="docutils literal notranslate"><span class="pre">precision</span></code>.  The value of <code class="docutils literal notranslate"><span class="pre">unit</span></code> defines the unit size—in meters—for all
entities in the library.  For example, if <code class="docutils literal notranslate"><span class="pre">unit</span> <span class="pre">=</span> <span class="pre">1e-6</span></code> (10⁻⁶ m, the default
value), a vertex at (1, 2) should be interpreted as a vertex in real world
position (1 × 10⁻⁶ m, 2 × 10⁻⁶ m).  If <code class="docutils literal notranslate"><span class="pre">unit</span></code> changes to 0.001, then that
same vertex would be located (in real world coordinates) at (0.001 m, 0.002 m),
or (1 mm, 2 mm).</p>
<p>The value of precision has to do with the type used to store coordinates in the
GDSII file: signed 4-byte integers.  Because of that, a finer coordinate grid
than 1 <code class="docutils literal notranslate"><span class="pre">unit</span></code> is usually desired to define coordinates.  That grid is
defined, in meters, by <code class="docutils literal notranslate"><span class="pre">precision</span></code>, which defaults to <code class="docutils literal notranslate"><span class="pre">1e-9</span></code> (10⁻⁹ m).
When the GDSII file is written, all vertices are snapped to the grid defined by
<code class="docutils literal notranslate"><span class="pre">precision</span></code>.  For example, for the default values of <code class="docutils literal notranslate"><span class="pre">unit</span></code> and
<code class="docutils literal notranslate"><span class="pre">precision</span></code>, a vertex at (1.0512, 0.0001) represents real world coordinates
(1.0512 × 10⁻⁶ m, 0.0001 × 10⁻⁶ m), or (1051.2 × 10⁻⁹ m, 0.1 × 10⁻⁹ m), which
will be rounded to integers: (1051 × 10⁻⁹ m, 0 × 10⁻⁹ m), or (1.051 × 10⁻⁶ m, 0
× 10⁻⁶ m).  The actual coordinate values written in the GDSII file will be the
integers (1051, 0).  By reducing the value of <code class="docutils literal notranslate"><span class="pre">precision</span></code> from 10⁻⁹ m to
10⁻¹² m, for example, the coordinates will have 3 additional decimal places of
precision, so the stored values would be (1051200, 100).</p>
<p>The downside of increasing the number of decimal places in the file is reducing
the range of coordinates that can be stored (in real world units).  That is
because the range of coordinate values that can be written in the file are
[-(2³²); 2³¹ - 1] = [-2,147,483,648; 2,147,483,647].  For the default
<code class="docutils literal notranslate"><span class="pre">precsision</span></code>, this range is [-2.147483648 m; 2.147483647 m].  If
<code class="docutils literal notranslate"><span class="pre">precision</span></code> is set to 10⁻¹² m, the same range is reduced by 1000 times:
[-2.147483648 mm; 2.147483647 mm].</p>
<p>GDSII files keep a record of both <code class="docutils literal notranslate"><span class="pre">unit</span></code> and <code class="docutils literal notranslate"><span class="pre">precision</span></code>, which means that
some care must be taken when mixing geometry from different files to ensure
they have the same <code class="docutils literal notranslate"><span class="pre">unit</span></code>.  For that reason, the use of the industry standard
(<code class="docutils literal notranslate"><span class="pre">unit</span> <span class="pre">=</span> <span class="pre">1e-6</span></code>) is recommended.  OASIS files always use this standard for
units, whereas <code class="docutils literal notranslate"><span class="pre">precision</span></code> can be freely chosen.  For that reason, when
saving or loading an OASIS file with Gdstk, the units can be automatic
converted.</p>
</section>
<section id="saving-a-layout-file">
<h3>Saving a Layout File<a class="headerlink" href="#saving-a-layout-file" title="Link to this heading"></a></h3>
<p>To save a GDSII file, simply use the <a class="reference internal" href="library/gdstk.Library.html#gdstk.Library.write_gds" title="gdstk.Library.write_gds"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gdstk.Library.write_gds()</span></code></a> method, as
in the <a class="reference internal" href="#first-layout"><span class="std std-ref">First Layout</span></a>.  An OASIS file can be similarly created with
<a class="reference internal" href="library/gdstk.Library.html#gdstk.Library.write_oas" title="gdstk.Library.write_oas"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gdstk.Library.write_oas()</span></code></a>.</p>
<p>An SVG image from a specific cell can also be exported through
<a class="reference internal" href="library/gdstk.Cell.html#gdstk.Cell.write_svg" title="gdstk.Cell.write_svg"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gdstk.Cell.write_svg()</span></code></a>, which was also demonstrated in
<a class="reference internal" href="#first-layout"><span class="std std-ref">First Layout</span></a>.</p>
</section>
<section id="loading-a-layout-file">
<h3>Loading a Layout File<a class="headerlink" href="#loading-a-layout-file" title="Link to this heading"></a></h3>
<p>The functions <a class="reference internal" href="library/gdstk.read_gds.html#gdstk.read_gds" title="gdstk.read_gds"><code class="xref py py-func docutils literal notranslate"><span class="pre">gdstk.read_gds()</span></code></a> and <a class="reference internal" href="library/gdstk.read_oas.html#gdstk.read_oas" title="gdstk.read_oas"><code class="xref py py-func docutils literal notranslate"><span class="pre">gdstk.read_oas()</span></code></a> load an
existing GDSII or OASIS file into a new instance of <a class="reference internal" href="library/gdstk.Library.html#gdstk.Library" title="gdstk.Library"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.Library</span></code></a>.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--19-input--1" name="tab-set--19" type="radio" /><label class="tab-label" for="tab-set--19-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load a GDSII file into a new library.</span>
<span class="n">lib1</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">read_gds</span><span class="p">(</span><span class="s2">&quot;filename.gds&quot;</span><span class="p">)</span>
<span class="c1"># Verify the unit used in the library.</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lib1</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>

<span class="c1"># Load the same file, but convert all units to nm.</span>
<span class="n">lib2</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">read_gds</span><span class="p">(</span><span class="s2">&quot;filename.gds&quot;</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">)</span>

<span class="c1"># Load an OASIS file into a third library.</span>
<span class="c1"># The library will use unit=1e-6, the default for OASIS.</span>
<span class="n">lib3</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">read_oas</span><span class="p">(</span><span class="s2">&quot;filename.oas&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--19-input--2" name="tab-set--19" type="radio" /><label class="tab-label" for="tab-set--19-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="c1">// Use units from infile</span>
<span class="n">Library</span><span class="w"> </span><span class="n">lib1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_gds</span><span class="p">(</span><span class="s">&quot;filename.gds&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>

<span class="c1">// Convert to new unit</span>
<span class="n">Library</span><span class="w"> </span><span class="n">lib2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_gds</span><span class="p">(</span><span class="s">&quot;filename.gds&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">1e-9</span><span class="p">);</span>

<span class="c1">// Use default OASIS unit (1e-6)</span>
<span class="n">Library</span><span class="w"> </span><span class="n">lib3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_oas</span><span class="p">(</span><span class="s">&quot;filename.oas&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Access to the cells in the loaded library is primarily provided through the
list <a class="reference internal" href="library/gdstk.Library.html#gdstk.Library.cells" title="gdstk.Library.cells"><code class="xref py py-attr docutils literal notranslate"><span class="pre">gdstk.Library.cells</span></code></a>.  As a shorthand, if the desired cell name is
know, the idiom <code class="docutils literal notranslate"><span class="pre">lib1[&quot;CELL_NAME&quot;]</span></code> can be used, although it is not as
efficient as building a cell dictionary if a large number of queries is
expected.</p>
<p>Additionally, the method <a class="reference internal" href="library/gdstk.Library.html#gdstk.Library.top_level" title="gdstk.Library.top_level"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gdstk.Library.top_level()</span></code></a> can be used to find
the top-level cells in the library (cells on the top of the hierarchy, i.e.,
cell that are not referenced by any other cells).</p>
</section>
<section id="raw-cells">
<h3>Raw Cells<a class="headerlink" href="#raw-cells" title="Link to this heading"></a></h3>
<p>Library loaded using the previous method have all their elements interpreted
and re-created by Gdstk.  This can be time-consuming for large layouts.  If the
reason for loading a file is simply to re-use it’s cells without any
modifications, the function <a class="reference internal" href="library/gdstk.read_rawcells.html#gdstk.read_rawcells" title="gdstk.read_rawcells"><code class="xref py py-func docutils literal notranslate"><span class="pre">gdstk.read_rawcells()</span></code></a> is much more efficient.</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--20-input--1" name="tab-set--20" type="radio" /><label class="tab-label" for="tab-set--20-input--1">Python</label><div class="tab-content docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load all cells from a GDSII file without creating the actual geometry</span>
<span class="n">cells</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">read_rawcells</span><span class="p">(</span><span class="s2">&quot;filename.gds&quot;</span><span class="p">)</span>

<span class="c1"># Use some loaded cell in the current design</span>
<span class="n">my_ref</span> <span class="o">=</span> <span class="n">gdstk</span><span class="o">.</span><span class="n">Reference</span><span class="p">(</span><span class="n">cells</span><span class="p">[</span><span class="s2">&quot;SOME_CELL&quot;</span><span class="p">],</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--20-input--2" name="tab-set--20" type="radio" /><label class="tab-label" for="tab-set--20-input--2">C++</label><div class="tab-content docutils container">
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">&lt;</span><span class="n">RawCell</span><span class="o">*&gt;</span><span class="w"> </span><span class="n">cells</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read_rawcells</span><span class="p">(</span><span class="s">&quot;filename.gds&quot;</span><span class="p">);</span>

<span class="n">Reference</span><span class="w"> </span><span class="n">my_ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="n">my_ref</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">cells</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;SOME_CELL&quot;</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method only works when using the GDSII format; OASIS does <em>not</em> support
<a class="reference internal" href="library/gdstk.RawCell.html#gdstk.RawCell" title="gdstk.RawCell"><code class="xref py py-class docutils literal notranslate"><span class="pre">gdstk.RawCell</span></code></a>.  Units are not changed in this process, so the
current design must use the same <code class="docutils literal notranslate"><span class="pre">unit</span></code> and <code class="docutils literal notranslate"><span class="pre">precision</span></code> as the loaded
cells.</p>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Gdstk Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="how-tos.html" class="btn btn-neutral float-right" title="How-Tos" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Lucas H. Gabrielli.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>